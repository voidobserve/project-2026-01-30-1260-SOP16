C51 COMPILER V9.60.7.0   TIME0                                                             02/05/2026 14:54:58 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIME0
OBJECT MODULE PLACED IN .\Release\Objects\time0.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\time0.c LARGE OPTIMIZE(9,SIZE) BROWSE INTVECTOR(0X000C) INCDI
                    -R(..\..\Libraries\Include;..\..\User) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(.\Release\Listings\time0.lst) OBJECT(.\Releas
                    -e\Objects\time0.obj)

line level    source

   1          #include "time0.h"
   2          #include "power_on.h"
   3          
   4          /**
   5           * @brief ≈‰÷√∂® ±∆˜TMR0 
   6           */
   7          void tmr0_config(void)
   8          {
   9   1          __EnableIRQ(TMR0_IRQn); //  πƒ‹timer0÷–∂œ
  10   1          IE_EA = 1;              //  πƒ‹◊‹÷–∂œ
  11   1      
  12   1      #define PEROID_VAL (SYSCLK / 128 / 1000 - 1) // ÷‹∆⁄÷µ=œµÕ≥ ±÷”/∑÷∆µ/∆µ¬  - 1
  13   1          // …Ë÷√timer0µƒº∆ ˝π¶ƒ‹£¨≈‰÷√“ª∏ˆ∆µ¬ Œ™1kHzµƒ÷–∂œ
  14   1          TMR_ALLCON = TMR0_CNT_CLR(0x1);                        // «Â≥˝º∆ ˝÷µ
  15   1          TMR0_PRH = TMR_PERIOD_VAL_H((PEROID_VAL >> 8) & 0xFF); // ÷‹∆⁄÷µ
  16   1          TMR0_PRL = TMR_PERIOD_VAL_L((PEROID_VAL >> 0) & 0xFF);
  17   1          TMR0_CONH = TMR_PRD_PND(0x1) | TMR_PRD_IRQ_EN(0x1);                          // º∆ ˝µ»”⁄÷‹∆⁄ ±‘ –Ì∑¢…˙
             -÷–∂œ
  18   1          TMR0_CONL = TMR_SOURCE_SEL(0x7) | TMR_PRESCALE_SEL(0x7) | TMR_MODE_SEL(0x1); // —°‘ÒœµÕ≥ ±÷”£¨128∑÷∆µ£
             -¨º∆ ˝ƒ£ Ω
  19   1      }
  20          
  21          // /**
  22          //  * @brief ø™∆Ù∂® ±∆˜TMR0£¨ø™ ºº∆ ±
  23          //  */
  24          // void tmr0_enable(void)
  25          // {
  26          //     // ÷ÿ–¬∏¯TMR0≈‰÷√ ±÷”
  27          //     TMR0_CONL &= ~(TMR_SOURCE_SEL(0x07)); // «Â≥˝∂® ±∆˜µƒ ±÷”‘¥≈‰÷√ºƒ¥Ê∆˜
  28          //     TMR0_CONL |= TMR_SOURCE_SEL(0x06);    // ≈‰÷√∂® ±∆˜µƒ ±÷”‘¥£¨ π”√œµÕ≥ ±÷”£®‘º21MHz£©
  29          
  30          //     __EnableIRQ(TMR0_IRQn); //  πƒ‹÷–∂œ
  31          //     IE_EA = 1;              // ¥Úø™◊‹÷–∂œ
  32          // }
  33          
  34          // /**
  35          //  * @brief πÿ±’∂® ±∆˜0£¨«Âø’º∆ ˝÷µ
  36          //  */
  37          // void tmr0_disable(void)
  38          // {
  39          //     // ≤ª∏¯∂® ±∆˜Ã·π© ±÷”£¨»√À¸Õ£÷πº∆ ˝
  40          //     TMR0_CONL &= ~(TMR_SOURCE_SEL(0x07)); // «Â≥˝∂® ±∆˜µƒ ±÷”‘¥≈‰÷√ºƒ¥Ê∆˜
  41          //     TMR0_CONL |= TMR_SOURCE_SEL(0x05);    // ≈‰÷√∂® ±∆˜µƒ ±÷”‘¥£¨≤ª”√»Œ∫Œ ±÷”
  42          
  43          //     // «Â≥˝∂® ±∆˜µƒº∆ ˝÷µ
  44          //     TMR0_CNTL = 0;
  45          //     TMR0_CNTH = 0;
  46          
  47          //     __DisableIRQ(TMR0_IRQn); // πÿ±’÷–∂œ£®≤ª πƒ‹÷–∂œ£©
  48          // }
  49          
  50          // extern void fun(void);
  51          // ∂® ±∆˜TMR0÷–∂œ∑˛ŒÒ∫Ø ˝
C51 COMPILER V9.60.7.0   TIME0                                                             02/05/2026 14:54:58 PAGE 2   

  52          void TIMR0_IRQHandler(void) interrupt TMR0_IRQn
  53          {
  54   1          // Ω¯»Î÷–∂œ…Ë÷√IP£¨≤ªø……æ≥˝
  55   1          __IRQnIPnPush(TMR0_IRQn);
  56   1      
  57   1          // ---------------- ”√ªß∫Ø ˝¥¶¿Ì -------------------
  58   1      
  59   1          // ÷‹∆⁄÷–∂œ
  60   1          if (TMR0_CONH & TMR_PRD_PND(0x1))
  61   1          {
  62   2              TMR0_CONH |= TMR_PRD_PND(0x1); // «Â≥˝pending
  63   2      
  64   2              flag_time_comes_during_power_on = 1; // ø™ª˙ª∫∆Ù∂Ø∆⁄º‰£¨øÿ÷∆√ø¥Œµ˜Ω⁄PWM’ºø’±»µƒ ±º‰
  65   2      
  66   2                  { // ”√”⁄…œµÁ∂‡æ√÷Æ∫Û£¨œﬁ÷∆PWM◊Ó¥Ûµƒ’ºø’±»
  67   3                  static u32 cnt = 0;
  68   3                  if (0 == flag_is_time_to_limit_pwm)
  69   3                  {
  70   4                      /*
  71   4                          »Áπ˚√ª”–µΩµΩœﬁ÷∆’ºø’±»µƒ ±º‰£®±Í÷æŒª≤ªŒ™1£©
  72   4                          ‘ÚΩ¯––º∆ ±
  73   4                      */
  74   4                      cnt++;
  75   4                      if (cnt >= SCHEDULE_TIME_TO_LIMIT_PWM)
  76   4                      {
  77   5                          cnt = 0;
  78   5                          flag_is_time_to_limit_pwm = 1;
  79   5                      }
  80   4                  }
  81   3              }
  82   2          }
  83   1      
  84   1          // ÕÀ≥ˆ÷–∂œ…Ë÷√IP£¨≤ªø……æ≥˝
  85   1          __IRQnIPnPop(TMR0_IRQn);
  86   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    155    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      4    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
